{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["'use strict';\nexport const createGalleryItemMarkup = images => {\n  return images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n            class=\"gallery-img img-fluid\" loading=\"lazy\" \n          />\n          <div class=\"text-list\">\n              <p class=\"text-likes\">Likes: ${likes}</p>\n              <p class=\"text-views\">Views: ${views}</p>\n              <p class=\"text-comments\">Comments: ${comments}</p>\n              <p class=\"text-downloads\">Downloads: ${downloads}</p>\n          </div>\n        </a>\n      </li>`\n    )\n    .join('');\n};\n","'use strict';\nimport axios from 'axios';\n\nconst API_KEY = '47936251-08966a92c9e59538871cb9ab8';\nconst BASE_URL = 'https://pixabay.com/api/';\naxios.defaults.baseURL = BASE_URL;\nexport const PER_PAGE = 15;\nexport const fetchPhotosByQuery = (query, imagePage = 1) => {\n  const searchParams = new URLSearchParams({\n    q: query,\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: PER_PAGE,\n    page: imagePage,\n  });\n\n  return axios(BASE_URL, {\n    params: searchParams,\n  });\n};\n","'use strict';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { createGalleryItemMarkup } from './js/render-functions.js';\nimport { fetchPhotosByQuery } from './js/pixabay-api.js';\nimport { PER_PAGE } from './js/pixabay-api.js';\n\nimport axios from 'axios';\n\nconst galleryEl = document.querySelector('.js-gallery');\nconst searchFormEl = document.querySelector('.js-search-form');\nconst loaderEl = document.querySelector('.loader');\nconst btnmEl = document.querySelector('.btn-more');\n\nlet imagePage = 1;\nlet totalPages = 0;\nlet searchQuery;\nbtnmEl.classList.add('d-none');\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n  searchQuery = form.elements.searchKeyword.value;\n  galleryEl.innerHTML = '';\n  btnmEl.classList.add('d-none');\n\n  if (searchQuery.trim() === '') {\n    iziToast.error({\n      message: 'Input field can not be empty',\n      color: 'red',\n      position: 'topRight',\n      timeout: 2000,\n      close: true,\n    });\n    form.reset();\n    return;\n  }\n  galleryEl.innerHTML = '';\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const { data } = await fetchPhotosByQuery(searchQuery);\n    if (data.total === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        color: 'red',\n        timeout: 2000,\n        close: true,\n      });\n      return;\n    }\n\n    galleryEl.insertAdjacentHTML(\n      'beforeend',\n      createGalleryItemMarkup(data.hits)\n    );\n\n    const lightbox = new SimpleLightbox('.js-gallery a', {\n      captionPosition: 'bottom',\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n    lightbox.refresh();\n\n    if (PER_PAGE < data.total) {\n      totalPages = Math.ceil(data.total / PER_PAGE);\n      console.log(imagePage);\n      if (totalPages > 1) {\n        btnmEl.classList.remove('d-none');\n      }\n    } else {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results\",\n        position: 'topRight',\n        color: 'red',\n        timeout: 2000,\n        close: true,\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  }\n  form.reset();\n  loaderEl.classList.add('is-hidden');\n  imagePage = 1;\n}\n\nconst smoothScrollOnLoadMore = () => {\n  const lastImage = galleryEl.querySelector('.gallery-item');\n  const imageHeight = lastImage.getBoundingClientRect().height;\n  const scrollHeight = imageHeight * 2;\n\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n};\n\nconst onLoadMorePressed = async event => {\n  try {\n    imagePage += 1;\n    btnmEl.classList.remove('d-none');\n    loaderEl.classList.remove('is-hidden');\n    const { data } = await fetchPhotosByQuery(searchQuery, imagePage);\n\n    if (data.total === 0) {\n      btnmEl.classList.add('d-none');\n      loaderEl.classList.add('is-hidden');\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        color: 'red',\n        timeout: 2000,\n        close: true,\n      });\n    }\n\n    galleryEl.insertAdjacentHTML(\n      'beforeend',\n      createGalleryItemMarkup(data.hits)\n    );\n    loaderEl.classList.add('is-hidden');\n\n    const lightbox = new SimpleLightbox('.js-gallery a', {\n      captionPosition: 'bottom',\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n    lightbox.refresh();\n\n    smoothScrollOnLoadMore();\n    if (0 < data.total - PER_PAGE * imagePage) {\n      if (totalPages > 1) {\n        btnmEl.classList.remove('d-none');\n      }\n    } else {\n      btnmEl.classList.add('d-none');\n    }\n    if (imagePage >= totalPages) {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results\",\n        position: 'topRight',\n        color: 'red',\n        timeout: 2000,\n        close: true,\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'Search params is not valid!',\n      color: 'red',\n      position: 'topRight',\n      timeout: 2000,\n      close: true,\n    });\n  }\n};\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nbtnmEl.addEventListener('click', onLoadMorePressed);\n"],"names":["createGalleryItemMarkup","images","largeImageURL","webformatURL","tags","likes","views","comments","downloads","API_KEY","BASE_URL","axios","PER_PAGE","fetchPhotosByQuery","query","imagePage","searchParams","galleryEl","searchFormEl","loaderEl","btnmEl","totalPages","searchQuery","onSearchFormSubmit","event","form","iziToast","data","SimpleLightbox","error","smoothScrollOnLoadMore","scrollHeight","onLoadMorePressed"],"mappings":"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"}